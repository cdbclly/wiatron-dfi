<nz-breadcrumb>
  <nz-breadcrumb-item>MRR System</nz-breadcrumb-item>
  <nz-breadcrumb-item>IMQM</nz-breadcrumb-item>
  <nz-breadcrumb-item>{{'imq-menu-maintenance' | translate}}</nz-breadcrumb-item>
  <nz-breadcrumb-item>{{'imq-menu-groupMaintaince' | translate}}</nz-breadcrumb-item>
</nz-breadcrumb>
<h2>{{'imq-menu-groupMaintaince' | translate}}</h2>
<div class="query">
  <span>{{'imq-mt-group' | translate}}</span>
  <!-- <input nz-input placeholder="" nzSize="default">
    <button nz-button nzType="primary">Query</button> -->
  <nz-select [(ngModel)]="curGroupId" (ngModelChange)="groupChange()" >
    <nz-option *ngFor="let group of groupList" [nzLabel]="group.name" [nzValue]="group.id"></nz-option>
  </nz-select>
</div>
<nz-divider></nz-divider>
<button nz-button [nzType]="'primary'" title="{{'imq-create' | translate}}" *ngIf="isAuthCreate" nzShape="circle" (click)="operationAdd()">
  <i class="anticon anticon-plus"></i>
</button>
<button class="iconbtn" nz-button [nzType]="'primary'" *ngIf="isAuthEdit" title="{{'imq-edit' | translate}}" nzShape="circle" (click)="operationEdit()">
  <i class="anticon anticon-edit"></i>
</button>

<div class="tableContainer">
  <nz-table #basicTable nzBordered nzShowQuickJumper [nzData]="dataSet" [nzPageSize]="10">
    <thead>
      <tr>
        <th>#</th>
        <th>{{'imq-mt-pageGroup' | translate}}</th>
        <th>{{'imq-mt-read' | translate}}</th>
        <th>{{'imq-mt-add' | translate}}</th>
        <th>{{'imq-mt-delete' | translate}}</th>
        <th>{{'imq-mt-modify' | translate}}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of basicTable.data, let i = index">
        <td class="no">{{i+1}}</td>
        <td class="pageGroup">{{data.functionRole.name | groupTrans : lang}}</td>
        <td>
          <label nz-checkbox [(ngModel)]="data.read" [nzDisabled]="true"></label>
        </td>
        <td>
          <label nz-checkbox [(ngModel)]="data.create" [nzDisabled]="true"></label>
        </td>
        <td>
          <label nz-checkbox [(ngModel)]="data.delete" [nzDisabled]="true"></label>
        </td>
        <td>
          <label nz-checkbox [(ngModel)]="data.edit" [nzDisabled]="true"></label>
        </td>
      </tr>
    </tbody>
  </nz-table>
</div>

<!-- 新增 -->
<nz-modal [nzWidth]="800" nzWrapClassName="vertical-center-modal" [(nzVisible)]="isAddDataVisible"
  nzMaskClosable="false" nzTitle="{{'imq-mt-addGroup' | translate}}" (nzOnCancel)="handleAddCancel()" [nzFooter]="modalAddFooter">
  <div class="field">
    <div>{{'imq-mt-groupName' | translate}}</div><input nz-input [(ngModel)]="newGroupName">
    <button nz-button nzType="primary" (click)="selectAllNew()"><i nz-icon type="check-square" theme="fill"></i>{{'imq-selectAll' | translate}}</button>
  </div>
  <div class="new-table">
    <nz-table #modalTableNew nzBordered [nzShowPagination]="false" [nzData]="[1]" [nzPageSize]="999">
      <thead>
        <tr>
          <th>#</th>
          <th>{{'imq-mt-pageGroup' | translate}}</th>
          <th>{{'imq-mt-read' | translate}}</th>
          <th>{{'imq-mt-add' | translate}}</th>
          <th>{{'imq-mt-delete' | translate}}</th>
          <th>{{'imq-mt-modify' | translate}}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of newGroup, let i = index">
          <td class="no">{{i+1}}</td>
          <td class="pageGroup">{{data['data'].functionRole.name}}</td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].read" [nzDisabled]="data['showAllAuth']"></label>
          </td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].create" [nzDisabled]="data['showAllAuth']"></label>
          </td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].delete" [nzDisabled]="data['showAllAuth']"></label>
          </td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].edit" [nzDisabled]="data['showAllAuth']"></label>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>
  <ng-template #modalAddFooter>
    <button nz-button nzType="default" (click)="handleAddCancel()">Cancel</button>
    <button nz-button nzType="primary" (click)="handleAddSave()" [disabled]="!newGroupName">Save</button>
  </ng-template>
</nz-modal>

<!-- 修改 -->
<nz-modal [nzWidth]="800" nzWrapClassName="vertical-center-modal" [(nzVisible)]="isEditDataVisible"
  nzMaskClosable="false" nzTitle="{{'imq-mt-editGroup' | translate}}" (nzOnCancel)="handleEditCancel()" [nzFooter]="modalEditFooter">
  <div class="field">
    <div>{{'imq-mt-groupName' | translate}}</div><input nz-input [(ngModel)]="editGroupName">
    <button nz-button nzType="primary" (click)="selectAllEdit()"><i nz-icon type="check-square" theme="fill"></i>{{'imq-selectAll' | translate}}</button>
  </div>
  <div class="new-table">
    <nz-table #modalTableEdit nzBordered [nzShowPagination]="false" [nzData]="editGroup" [nzPageSize]="999">
      <thead>
        <tr>
          <th>#</th>
          <th>{{'imq-mt-pageGroup' | translate}}</th>
          <th>{{'imq-mt-read' | translate}}</th>
          <th>{{'imq-mt-add' | translate}}</th>
          <th>{{'imq-mt-delete' | translate}}</th>
          <th>{{'imq-mt-modify' | translate}}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of modalTableEdit.data, let i = index">
          <td class="no">{{i+1}}</td>
          <td class="pageGroup">{{data['data'].functionRole.name}}</td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].read" [nzDisabled]="data['showAllAuth']"></label>
          </td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].create" [nzDisabled]="data['showAllAuth']"></label>
          </td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].delete" [nzDisabled]="data['showAllAuth']"></label>
          </td>
          <td>
            <label nz-checkbox [(ngModel)]="data['data'].edit" [nzDisabled]="data['showAllAuth']"></label>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>
  <ng-template #modalEditFooter>
    <button nz-button nzType="default" (click)="handleEditCancel()">Cancel</button>
    <button nz-button nzType="primary" (click)="handleEditSave()" [disabled]="!editGroupName">Save</button>
  </ng-template>
</nz-modal>
