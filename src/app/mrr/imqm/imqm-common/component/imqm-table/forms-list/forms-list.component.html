<div class="box-table">
    <nz-table
    #nzData
    nzBordered
    nzShowQuickJumper
    [nzData]="tableData"
    [nzPageSize]="5">
    <thead>
      <tr style="text-align: center;font-size: 10px;">
          <th nzShowExpand></th>
          <th>{{'imq-pop-table=formNo' | translate}}</th>
          <th>{{'imq-pop-table-status' | translate}}</th>
          <th>{{'imq-pop-table-type' | translate}}</th>
          <th>{{'imq-pop-table-detail' | translate }}</th>
      </tr>
    </thead>
    <tbody>
        <ng-template ngFor let-data [ngForOf]="nzData.data">
      <tr>
          <td nzShowExpand [(nzExpand)]="data['expand']" (click)="showDetail(data)"></td>
          <!-- <td style="font-size: 10px;">{{i+1}}</td> -->
          <td>{{data['number']}}</td>
          <td><div class="{{data['status'] | lightStatus}}"></div>{{data['status']}}</td>
          <td>{{data['objName'] | formsNoCate | translate }}</td>
          <td><i class="anticon anticon-search" (click)="showTrdTable(data)"></i></td>
      </tr>
      <tr *ngIf="data['rawData']" [nzExpand]="data['expand']">
          <td></td>
          <td colspan="4">
              <div class="box-table">
                  <table>
                    <tbody>
                      <tr style="border-top: 1px solid lightslategray;border-left: 1px solid lightslategray;">
                        <td class="tr-headstyle"  style="color: black;width:15%;border-color: lightslategray;">{{'imq-supplier' | translate}}</td>
                        <td style="color: black;width:15%;border-color: lightslategray;">{{data['vendor']}}</td>
                        <td  class="tr-headstyle" style="color: black;width:15%;border-color: lightslategray;">{{'imq-pop-table=formNo' | translate}}</td>
                        <td style="color: black;width:15%;border-color: lightslategray;">{{data['number']}}</td>
                        <td  class="tr-headstyle" style="color: black;width:15%;border-color: lightslategray;">{{'imq-pop-table-status' | translate}}</td>
                        <td style=" color: black;width:15%;border-color: lightslategray;">{{data['status']}}</td>
                      </tr>
                      <tr style="border-left: 1px solid lightslategray;">
                        <td  class="tr-headstyle" style="background-color: white; color: black;width:15%;border-color: lightslategray;">Y/R</td>
                        <td style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{data['rawData']['yieldRate'] | noDataCheck : 'N/A'}}</td>
                        <td  class="tr-headstyle" style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{'imq-model' | translate}}</td>
                        <td style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{data['model']}}</td>
                        <td  class="tr-headstyle" style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{'imq-date' | translate}}</td>
                        <td style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{data['executionTime'] * 1000 | date:'yyyy-MM-dd HH:mm:ss'}}</td>
                    </tr>
                    <tr style="border-left: 1px solid lightslategray;">
                        <td class="tr-headstyle" style="border-color: lightslategray;" >SPC Result</td>
                        <td style="border-color: lightslategray;">{{data['spcResult'] | noDataCheck : 'N/A'}}</td>
                        <td class="tr-headstyle" style="color: black;width:15%;border-color: lightslategray;">{{'imq-proName' | translate}}</td>
                        <td style=" color: black;width:15%;border-color: lightslategray;">{{data['productName']}}</td>
                        <td class="tr-headstyle" style="color: black;width:15%;border-color: lightslategray;">{{'imq-shift' | translate}}</td>
                        <td style="color: black;width:15%;border-color: lightslategray;">{{data['shift'] | noDataCheck : 'N/A'}}</td>
                    </tr>
                    <tr style="border-left: 1px solid lightslategray;">
                        <td class="tr-headstyle" style="border-color: lightslategray;background-color: white;">CPK Result</td>
                        <td style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{data['cpkResult'] | noDataCheck : 'N/A'}}</td>
                        <td class="tr-headstyle" style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{'imq-partNumber' | translate}}</td>
                        <td style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{data['partNumber'] | noDataCheck : 'N/A'}}</td>
                        <td class="tr-headstyle" style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{'imq-pop=table-machineNo' | translate}}</td>
                        <td style="background-color: white; color: black;width:15%;border-color: lightslategray;">{{data['machineID'] | noDataCheck : 'N/A'}}</td>
                    </tr>
                    <!-- 在这里新增内容 -->
                    <tr *ngIf="data['flag']" style="border-left: 1px solid lightslategray;">
                      <td class="tr-headstyle" style="border-color: lightslategray;" >Reason Code</td>
                      <td style="border-color: lightslategray;">{{data['reasonCode'] | noDataCheck : 'N/A'}}</td>
                      <td class="tr-headstyle" style="color: black;width:15%;border-color: lightslategray;">Reason Description</td>
                      <td style=" color: black;width:15%;border-color: lightslategray;">{{data['ReasonDesc']}}</td>
                      <td class="tr-headstyle" style="color: black;width:15%;border-color: lightslategray;">Reason Remark</td>
                      <td style="color: black;width:15%;border-color: lightslategray;">{{data['reasonRemark'] | noDataCheck : 'N/A'}}</td>
                    </tr>


                    <tr style="border-left: 1px solid lightslategray;">
                      <td colspan="3" style="border-color: lightslategray;background-color: white;">
                        <div style="max-height: 80px;overflow-y: auto;">
                          {{'imq-reason' | translate}}:
                            <p *ngFor="let reason of data['reasonlist']">{{reason}}</p>
                        </div>
                        </td>
                      <td colspan="3" style="border-color: lightslategray;background-color: white;">
                        <div style="max-height: 80px;overflow-y: auto;">
                          {{'imq-action'| translate }}:
                            <p *ngFor="let reply of data['measureslist']">{{reply}}</p>
                        </div>
                        </td>
                    </tr>
                    <tr>
                      <!-- <td colspan="6" [hidden]="!isEdit" style="background-color: #f0f0f0; text-align: center;"> -->
                        <td colspan="6"  style="background-color: #f0f0f0; text-align: center;">
                          <button nz-button nzType="primary" [disabled]="!isActive ||(data['status'] !== 'ongoing' && data['status'] !== 'open')" style="border-radius:6px"  (click)="close(data['number'], data['objName'])">Close</button>
                          <button nz-button nzType="primary" [disabled]="!isActive ||(data['status'] !== 'ongoing' && data['status'] !== 'open')" style="border-radius:6px"  (click)="reject(data['number'], data['objName'])">Reject</button>
                        </td>
                    </tr>
                    </tbody>
                  </table>
                  </div>
          </td>
      </tr>
    </ng-template>
    </tbody>
    </nz-table>
    </div>
