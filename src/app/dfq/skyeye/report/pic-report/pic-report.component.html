<nz-breadcrumb>
  <nz-breadcrumb-item>Report</nz-breadcrumb-item>
  <nz-breadcrumb-item>DFQ Report</nz-breadcrumb-item>
  <nz-breadcrumb-item>Sky eye Report</nz-breadcrumb-item>
  <nz-breadcrumb-item>PIC Report</nz-breadcrumb-item>
</nz-breadcrumb>
<div class="content">
  PIC Report
</div>
<div class="query-row">
  <div class="field1" (click)="changeStatus('pic', $event)" style="width: 45%;margin-left: 35px;">
    <span style="margin-right: 15px;">日期</span>
    <!-- <nz-range-picker style="width: 70%;" [nzFormat]="dateFormat" [(ngModel)]="datefroms" (ngModelChange)="getOptions($event, 'cur_date')"></nz-range-picker> -->
    <nz-date-picker nzShowTime nzFormat="yyyy-MM-dd HH:mm:ss" nzPlaceHolder="開始時間" [(ngModel)]="dateInputFrom"
      (ngModelChange)="getOptions($event, 'dateFrom')"></nz-date-picker>
    ~
    <nz-date-picker nzShowTime nzFormat="yyyy-MM-dd HH:mm:ss" nzPlaceHolder="結束時間" [(ngModel)]="dateInputTo"
      (ngModelChange)="getOptions($event, 'dateTo')"></nz-date-picker>
  </div>
  <span *ngIf="cur_site && cur_plant.length > 0 && cur_fun.length > 0 && cur_pic"
    [ngStyle]="{'cursor': alertInfos.length > 0 ? 'pointer': 'no-drop'}" style="font-size: 20px;"><i
      class="anticon anticon-download" (click)="downloadFile()"></i></span>
</div>
<div class="query-row">
  <div class="field1">
    <span style="margin-left: 25px;">
      <span style="color: red;margin-right: 10px;">*</span>
      <span style="margin-right: 10px;">廠別</span>
    </span>
    <nz-select nzShowSearch nzAllowClear [(ngModel)]="cur_site" [nzDisabled]="isSelectValid"
      (ngModelChange)="getOptions($event, 'cur_site')">
      <nz-option *ngFor="let site of objectKeys(siteGroup)" [nzLabel]="site" [nzValue]="site"></nz-option>
    </nz-select>
  </div>
  <div class="field" (click)="changeStatus('plant', $event)">
    <span style="width: 24%;">
      <span style="color: red">*</span>
      <span>廠區</span>
    </span>
    <nz-select nzShowSearch nzMode="multiple" nzAllowClear [(ngModel)]="cur_plant" [nzDisabled]="isSelectValid"
      (ngModelChange)="getOptions($event, 'cur_plant')">
      <nz-option *ngFor="let plant of objectKeys(plantGroup)" [nzLabel]="plant" [nzValue]="plant"></nz-option>
    </nz-select>
  </div>
  <div class="field" (click)="changeStatus('function', $event)">
    <span style="width: 24%;">
      <span style="color: red">*</span>
      <span>部門</span>
    </span>
    <nz-select nzShowSearch nzMode="multiple" nzAllowClear [(ngModel)]="cur_fun" [nzDisabled]="isSelectValid"
      (ngModelChange)="getOptions($event, 'cur_fun')">
      <nz-option *ngFor="let fun of objectKeys(funGroup)" [nzLabel]="fun" [nzValue]="fun"></nz-option>
    </nz-select>
  </div>
  <div class="field" (click)="changeStatus('pic', $event)">
    <span style="width: 24%;">
      <span style="color: red">*</span>
      <span>責任人</span>
    </span>
    <nz-select nzShowSearch nzAllowClear [(ngModel)]="cur_pic" [nzDisabled]="isSelectValid"
      (ngModelChange)="getOptions($event, 'cur_pic')">
      <nz-option *ngFor="let pic of objectKeys(picGroup)" [nzLabel]="pic" [nzValue]="pic"></nz-option>
    </nz-select>
  </div>
</div>
<nz-divider style="margin-top: 0;"></nz-divider>
<div *ngIf="picItems.length > 0">
  <nz-table #nzData nzBordered nzShowQuickJumper [nzFrontPagination]="pageDivide" [nzData]="picItems" [nzPageSize]="1"
    [nzWidthConfig]="THwidth">
    <thead>
      <tr style="text-align: center;font-size: 10px;">
        <th>姓名</th>
        <th>年資</th>
        <th>部門</th>
        <!-- <th>職等</th> -->
        <th>6 sigma</th>
        <th>專家技能認證</th>
        <th>部門主管</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of nzData.data;  let i = index;">
        <td style="font-size: 10px;">{{data.name}}</td>
        <td style="font-size: 10px;">{{data.seniority}}</td>
        <td style="font-size: 10px;">{{data.dept}}</td>
        <!-- <td></td> -->
        <!-- <td>{{data.jobLevel}}</td> -->
        <td style="font-size: 10px;">{{data.p6sigma}}</td>
        <td style="font-size: 10px;">{{data.jobLevel}}</td>
        <td style="font-size: 10px;">{{data.supervisor}}</td>
      </tr>
    </tbody>
  </nz-table>
</div>
<div class="chart-content" *ngIf="picItems.length > 0">
  <div class="chart-box">
    <!-- <div class="title">结案时间统计</div> -->
    <div class="report_box" echarts [options]="alert_char" (chartClick)="showDetail('alert', $event)"></div>
  </div>
  <div class="chart-box">
    <!-- <div class="title">Total issue status</div> -->
    <div class="report_box" echarts [options]="status_char" (chartClick)="showDetail('status', $event)"></div>
  </div>
  <div class="chart-box">
    <!-- <div class="title">Efficiency</div> -->
    <div class="report_box" echarts [options]="eff_char" (chartClick)="showDetail('eff', $event)"></div>
  </div>
</div>
<nz-modal [(nzVisible)]="isVisible" nzTitle="" nzWidth="96%" (nzOnCancel)="handleCancel()" [nzClosable]="cancelOK"
  [nzFooter]="footer" (nzOnOk)="handleOk()">
  <div class="box-table">
    <nz-table #nzData nzBordered nzShowQuickJumper [nzData]="table_box" [(nzPageIndex)]="curPage" [nzPageSize]="5"
      [nzWidthConfig]="tableW">
      <thead>
        <tr style="text-align: center;font-size: 10px;">
          <th>No</th>
          <th>線別</th>
          <th>機種</th>
          <th>站別</th>
          <th>報警信息</th>
          <th>治具編號</th>
          <th>根本原因</th>
          <th>Action</th>
          <th>輔助決策</th>
          <th>狀態</th>
          <th>報警時間</th>
          <th>處理時間</th>
          <th>結案時間</th>
          <th>部門</th>
          <th>PIC</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of nzData.data;  let i = index;">
          <td style="font-size: 10px;">{{(curPage - 1) * 5 + i + 1}}</td>
          <td style="font-size: 10px;">{{item['lineId']}}</td>
          <td style="font-size: 10px;">{{item['modelId']}}</td>
          <td style="font-size: 10px;">{{item['stationId']}}</td>
          <td style="font-size: 10px;">{{item['warningInfo']}}</td>
          <td style="font-size: 10px;">{{item['equipNo']}}</td>
          <td style="font-size: 10px;">{{item['picReasonDesc']}}</td>
          <td style="font-size: 10px;">{{item['action']}}</td>
          <td style="font-size: 10px;">{{item['decision']}}</td>
          <td style="font-size: 10px;">{{item['status']}}</td>
          <td style="font-size: 10px;">{{item['occurTime']}}</td>
          <td style="font-size: 10px;">{{item['handleTime']}}</td>
          <td style="font-size: 10px;">{{item['endingTime']}}</td>
          <td style="font-size: 10px;">{{item['dept']}}</td>
          <td style="font-size: 10px;">{{item['pic']}}</td>
        </tr>
      </tbody>
    </nz-table>
